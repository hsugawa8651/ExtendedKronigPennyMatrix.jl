<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage · ExtendedKronigPennyMatrix.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://hsugawa8651.github.io/ExtendedKronigPennyMatrix.jl/usage/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendedKronigPennyMatrix.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Usage</a></li><li><a class="tocitem" href="../usageja/">使い方</a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/hsugawa8651/ExtendedKronigPennyMatrix.jl/blob/master/docs/src/usage.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h1><p>Here is a sample REPL session to draw a dispersion relationship by using this package.</p><p>First, construct <code>FiniteSquareWell</code> potential object.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ExtendedKronigPennyMatrix</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v0=10;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rho=0.5 # b/a;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pot=FiniteSquareWell(v0, rho)</code><code class="nohighlight hljs ansi" style="display:block;">FiniteSquareWell(10, 0.5)</code></pre><p>Use <code>get_function</code> method to acquire potential function.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; begin
          pf = get_potential(pot)
          a = 1
          xs=-a:a/100:2a
          plot(xs, pf.(xs), &quot;k&quot;)
          xlim(0,1)
          xlabel(L&quot;$x / a$&quot;)
          ylabel(L&quot;Energy / $E_0$&quot;)
          title( L&quot;$\rho =$&quot;*string(rho))
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: @L_str not defined
in expression starting at none:7</code></pre><p><img src="plot1.png" alt="plot1"/></p><p>Define <code>Model</code> by calling its constructor.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Ka=0.0 # wavenumber multiplied by a;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model=Model(pot, Ka)</code><code class="nohighlight hljs ansi" style="display:block;">Model{FiniteSquareWell}(FiniteSquareWell(10, 0.5), 0.0, 60, 121, Alternates(60), [5.0 3.183098861837907 … -0.0 -0.0; 3.183098861837907 9.0 … -0.05395082816674419 0.05218194855471979; … ; -0.0 -0.05395082816674419 … 14405.0 -0.0; -0.0 0.05218194855471979 … -0.0 14405.0])</code></pre><p>The field <code>hnm</code> of model contains Hamiltonian matrix.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; typeof(model.hnm)</code><code class="nohighlight hljs ansi" style="display:block;">Array{Float64,2}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; size(model.hnm)</code><code class="nohighlight hljs ansi" style="display:block;">(121, 121)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; model.hnm[1:5,1:5]</code><code class="nohighlight hljs ansi" style="display:block;">5×5 Array{Float64,2}:
  5.0      3.1831    3.1831   -0.0      -0.0
  3.1831   9.0      -0.0       3.1831   -1.06103
  3.1831  -0.0       9.0      -1.06103   3.1831
 -0.0      3.1831   -1.06103  21.0      -0.0
 -0.0     -1.06103   3.1831   -0.0      21.0</code></pre><p>Use <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.eigvals"><code>LinearAlgebra.eigvals</code></a> method to compute its energy eigenvalues. Refer to the <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/"><code>LinearAlgebra</code></a> standard library section in Julia documentation.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using LinearAlgebra</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; evs=eigvals(model.hnm);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; evs[1:3]</code><code class="nohighlight hljs ansi" style="display:block;">3-element Array{Float64,1}:
  1.968065505811152
  7.582164159222251
 11.500508757011424</code></pre><p>Draw dispersion curve by scanning <code>Ka</code> values between <span>$[-\pi, \pi]$</span>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PyPlot</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: Installing matplotlib via the Conda matplotlib package...
[ Info: Running `conda install -q -y matplotlib` in root environment
Channels:
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done

# All requested packages already installed.

ERROR: InitError: PyError (PyImport_ImportModule

The Python package matplotlib could not be imported by pyimport. Usually this means
that you did not install matplotlib in the Python version being used by PyCall.

PyCall is currently configured to use the Julia-specific Python distribution
installed by the Conda.jl package.  To install the matplotlib module, you can
use `pyimport_conda(&quot;matplotlib&quot;, PKG)`, where PKG is the Anaconda
package that contains the module matplotlib, or alternatively you can use the
Conda package directly (via `using Conda` followed by `Conda.add` etcetera).

Alternatively, if you want to use a different Python distribution on your
system, such as a system-wide Python (as opposed to the Julia-specific Python),
you can re-configure PyCall with that Python.   As explained in the PyCall
documentation, set ENV[&quot;PYTHON&quot;] to the path/name of the python executable
you want to use, run Pkg.build(&quot;PyCall&quot;), and re-launch Julia.

) &lt;class &#39;ImportError&#39;&gt;
ImportError(&quot;/opt/hostedtoolcache/julia/1.5.4/x64/bin/../lib/julia/libstdc++.so.6: version `GLIBCXX_3.4.29&#39; not found (required by /home/runner/.julia/conda/3/x86_64/lib/python3.12/site-packages/matplotlib/_c_internal_utils.cpython-312-x86_64-linux-gnu.so)&quot;)
  File &quot;/home/runner/.julia/conda/3/x86_64/lib/python3.12/site-packages/matplotlib/__init__.py&quot;, line 161, in &lt;module&gt;
    from . import _api, _version, cbook, _docstring, rcsetup
  File &quot;/home/runner/.julia/conda/3/x86_64/lib/python3.12/site-packages/matplotlib/cbook.py&quot;, line 32, in &lt;module&gt;
    from matplotlib import _api, _c_internal_utils

during initialization of module PyPlot</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using LaTeXStrings</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; clf()</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: clf not defined</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; begin
          a = 1
          xs=-a:a/100:2a
          plot(xs .- 1/2, pf.(xs), &quot;k&quot;)  # Holizontally shift to centerize the potential well
          cm=get_cmap(&quot;tab10&quot;)
          for Ka in (-18:18)/18*π
             model=Model(pot, Ka)
             ev = eigvals(model.hnm)
             for i in 1:5
                plot(Ka/ π, ev[i], &quot;.&quot;, color=cm(i-1))
             end
          end
          xlim(-1,1)
          ylim(-2,32)
          xlabel(L&quot;$Ka / \pi$&quot;)
          ylabel(L&quot;Energy / $E_0$&quot;)
          title( L&quot;$\rho =$&quot;*string(rho))
       end</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: pf not defined</code></pre><p><img src="plot2.png" alt="plot2"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../usageja/">使い方 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 4 June 2025 07:40">Wednesday 4 June 2025</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
